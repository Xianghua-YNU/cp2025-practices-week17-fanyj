# 项目：波动方程的FTCS解 - 实验报告

**学生姓名：** 范玉洁 **学号：** 220221050183 **完成日期：**6.18

## 1. 实验目的

本实验旨在通过有限差分法（FTCS方案）模拟一维波动方程，理解其数值求解过程，并可视化弦的振动。

## 2. 核心算法

### 2.1 算法思路

本实验采用FTCS（Forward-Time Central-Space）方案求解一维波动方程。首先，将连续的波动方程离散化为差分方程。然后，根据给定的初始条件（初始位移和初始速度）计算第一个时间步的弦位移。接着，通过迭代更新公式，从已知的前两个时间步的位移计算出当前时间步的位移，直到模拟结束。在整个过程中，严格遵守边界条件，即弦的两端位移始终为零。

### 2.2 关键代码片段

```python
# 提取参数并计算稳定性条件
a = parameters['a']
dx = parameters['dx']
dt = parameters['dt']
c = (a * dt / dx)** 2
if c >= 1:
    print("警告: 稳定性条件 c = (a*dt/dx)^2 >= 1，数值解可能不稳定")

# 初始化解数组并应用初始条件
u = np.zeros((Nx, Nt))
u[:, 1] = u[:, 0] + dt * u_t(x, parameters['C'], parameters['d'], parameters['sigma'], L)

# FTCS核心迭代算法
for j in range(1, Nt - 1):
    for i in range(1, Nx - 1):
        u[i, j+1] = 2 * (1 - c) * u[i, j] + c * (u[i+1, j] + u[i-1, j]) - u[i, j-1]
```

## 3. 实验结果

### 3.1 主要输出
![屏幕截图 2025-06-18 114345](https://github.com/user-attachments/assets/4953cf8a-389e-4dee-8149-3c27331d5ebf)

![屏幕截图 2025-06-18 114335](https://github.com/user-attachments/assets/8c30c2f3-90ae-435c-b49e-a8b6d9ffd81c)

波形演化：初始时刻弦静止，在\(x=0.1m\)附近施加初始速度，产生向两端传播的脉冲波。波到达边界后发生反射，形成往复振动。关键时间点波形：\(t=0s\)：弦处于平衡位置，位移为 0\(t=0.025s\)：脉冲波传播至\(x=0.25m\)和\(x=0.75m\)附近\(t=0.05s\)：波到达两端并开始反射\(t=0.1s\)：反射波相遇，形成复杂的叠加波形
### 3.2 结果验证

边界条件验证：始终满足\(u(0,t)=u(L,t)=0\)，两端位移在整个模拟过程中保持为零。波形传播速度：实测波速与设定值\(a=100m/s\)一致，通过测量波传播距离与时间的关系验证了数值解的准确性。稳定性分析：当\(c=0.25 \lt 1\)时，解稳定且收敛，波形清晰无畸变尝试将dt增大至\(0.0001s\)使\(c=1\)时，解开始出现轻微振荡当\(c=1.21 \gt 1\)时，解迅速发散，验证了 CFL 条件的必要性初始条件一致性：初始速度剖面与u_t函数定义一致，首个时间步的位移计算正确反映了初始速度的影响。
## 4. 问题与收获

### 4.1 主要问题

[请在此处列出你在实验过程中遇到的1-2个主要困难，例如：
*   如何处理初始速度条件？
*   理解初始速度如何转化为首个时间步的位移，需要明确有限差分近似的物理意义
处理高斯型初始速度剖面的离散化时，曾出现边界附近计算误差
*   如何确保数值稳定性？
*   初始设置dt较大导致\(c \gt 1\)，解出现剧烈振荡甚至发散不理解c与稳定性的具体关系，未能正确调整参数
*   动画制作中的挑战？]
*   原始动画帧率过高导致显示不流畅
初始版本未处理边界条件可视化，波形在边界处出现异常

### 4.2 解决方法

[请在此处描述你如何解决上述问题。例如：
*   查阅资料理解初始速度的离散化方法。
*   通过查阅有限差分方法资料，明确了\(u(x, \Delta t) \approx u(x, 0) + \Delta t \cdot \psi(x)\)的近似关系采用向量化计算替代循环，提高了初始速度剖面的计算精度
*   调整时间步长以满足CFL条件。
*   深入学习 CFL 条件，理解\(c = a\Delta t/\Delta x\)的物理意义通过减小dt或增大dx使\(c \lt 1\)，确保数值稳定性
*   学习Matplotlib动画模块的使用。]
*   降低帧更新频率，设置合理的interval参数显式处理边界条件，确保\(u(0,t)\)和\(u(L,t)\)始终为零

### 4.3 主要收获

[请在此处总结你在本次实验中的3-5句话学习收获，例如：
理论认知提升：
深入理解了波动方程的物理意义和 FTCS 差分格式的推导过程
掌握了 CFL 条件对数值稳定性的决定性作用
编程技能提升：
熟练运用 NumPy 进行科学计算和向量化操作
掌握 Matplotlib 动画制作技巧，能够直观展示动态物理过程
工程实践经验：
学会参数调试与稳定性分析，建立了数值模拟的工程思维
理解了理论模型与数值实现之间的差异及误差来源

## 5. 思考题（可选）

1.  如果改变初始速度剖面 $\psi(x)$ 的形状，弦的振动模式会有什么变化？
   宽度参数\(\sigma\)：减小\(\sigma\)会使初始速度分布更集中，产生更尖锐的脉冲波增大\(\sigma\)会使速度分布更平缓，形成宽脉冲波偏移量d：改变d会移动初始扰动的位置，影响波到达边界的时间d越接近端点，波反射回中心的时间越短振幅常数C：增大C会增加初始扰动能量，使振动振幅增大C不影响波形传播速度，仅改变振动强度
3.  尝试使用不同的 $\Delta t$ 和 $\Delta x$ 值，观察数值解的稳定性和准确性如何受到影响。当 $c \ge 1$ 时会发生什么？
   对稳定性的影响：当\(c = a\Delta t/\Delta x \geq 1\)时，数值解失去稳定性，表现为振幅指数增长或剧烈振荡减小\(\Delta t\)或增大\(\Delta x\)使\(c \lt 1\)可恢复稳定性对准确性的影响：减小\(\Delta x\)可提高空间分辨率，使波形更平滑减小\(\Delta t\)可提高时间分辨率，更好捕捉快速变化的波形但过小的步长会增加计算量，引入舍入误差实际应用建议：选择\(\Delta t\)和\(\Delta x\)时，优先满足\(c \lt 0.8\)以保证稳定性根据所需精度和计算效率，折中选择步长参数可通过网格收敛性测试确定最优步长组合
