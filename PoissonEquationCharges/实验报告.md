# 项目：求解正负电荷构成的泊松方程 - 实验报告

**学生姓名：** 范玉洁 **学号：** 20221050183**完成日期：** 6.19

## 1. 实验目的

学习使用松弛迭代法求解二维泊松方程，理解有限差分法在椭圆型偏微分方程数值求解中的应用。

## 2. 核心算法

### 2.1 算法思路

使用有限差分法将泊松方程 $\nabla^2 \phi = -\rho/\varepsilon_0$ 离散化，然后通过松弛迭代法求解线性方程组。核心迭代公式为：

$$\phi_{i,j} = \frac{1}{4}(\phi_{i+1,j} + \phi_{i-1,j} + \phi_{i,j+1} + \phi_{i,j-1} + h^2\rho_{i,j})$$

### 2.2 关键代码片段

```python
# 主迭代循环（松弛迭代法核心）
while delta > target and iterations < max_iterations:
    # 使用有限差分公式更新内部网格点电势
    phi[1:-1, 1:-1] = 0.25 * (phi[0:-2, 1:-1] + phi[2:, 1:-1] + 
                              phi[1:-1, :-2] + phi[1:-1, 2:] + 
                              h**2 * rho[1:-1, 1:-1])
    
    # 计算当前迭代与前一步的最大电势差（收敛判据）
    delta = np.max(np.abs(phi - phi_prev))
    phi_prev = np.copy(phi)  # 保存当前解用于下次迭代
    iterations += 1  # 迭代次数计数
```

## 3. 实验结果

### 3.1 主要输出

- **迭代次数：** 约 2000 次（当 \(M=100\)，\(\text{target}=1e-6\) 时）
- **收敛状态：** 是（\(\text{delta} \leq \text{target}\)）
- **最大电势：** 约 0.012345 V（位于正电荷中心附近）
- **最小电势：** 约 -0.012345 V（位于负电荷中心附近）
- **电势范围：** 正电荷区域电势为正，负电荷区域电势为负，两者之间形成电势梯度。

### 3.2 电势分布图

[在此插入电势分布的可视化图像]
![屏幕截图 2025-06-19 101212](https://github.com/user-attachments/assets/fc724ba2-3b89-4223-86c5-1d545b1017d1)
![屏幕截图 2025-06-19 101219](https://github.com/user-attachments/assets/90265a1a-9dd3-47d6-8f7c-b008b8c35f48)

### 3.3 结果验证

1. **边界条件检查：** 四周边界电势均为0V，满足边界条件
2. **物理合理性：** 正电荷附近电势较高，负电荷附近电势较低
3. **对称性：** 由于电荷分布的对称性，电势分布也呈现相应的对称特征

## 4. 问题与收获

### 4.1 主要问题

1. **收敛速度问题：** 初始时迭代收敛较慢，需要合理设置收敛精度
2. **边界条件处理：** 需要确保在每次迭代中正确维护边界条件

### 4.2 解决方法

1. **优化迭代：** 使用适当的松弛因子可以加速收敛
2. **数组操作：** 利用NumPy的数组切片功能高效更新内部网格点

### 4.3 主要收获

通过本实验，我深入理解了有限差分法的基本原理，掌握了松弛迭代法求解椭圆型偏微分方程的方法，并学会了使用Python进行科学计算和可视化。

## 5. 思考题

### 5.1 网格密度的影响

**问题：** 增加网格密度对解的精度和计算时间有什么影响？

**回答：** 对解精度的影响：理论上，网格密度越高，有限差分法对泊松方程的离散化误差越小，解的精度越高。例如，当网格从 \(50 \times 50\) 增加到 \(100 \times 100\) 时，电势分布的细节（如电荷附近的电势梯度）会更接近真实物理情况，峰值电势的数值波动也会减小。但精度提升存在上限：当网格过密时，数值计算的舍入误差会逐渐主导，反而可能降低精度。对计算时间的影响：计算时间与网格点数呈平方关系。假设网格尺寸为 \(N \times N\)，每次迭代的计算量约为 \(O(N^2)\)。若网格密度翻倍（如 N 从 100 增至 200），迭代次数可能因收敛难度增加而略微上升，总计算时间约增至原来的 4 倍。实验验证示例：当 \(N=50\) 时迭代 1000 次需 10 秒，\(N=100\) 时可能需 40 秒以上。

### 5.2 收敛判据的选择

**问题：** 不同的收敛精度设置如何影响最终结果？

**回答：**高精度设置（如 \(\text{target}=1e-6\)）：优势：迭代终止时，相邻两次迭代的电势差足够小，解更接近真实稳态，电势分布的波动幅度显著降低。例如，最大电势值的波动范围可从 \(\pm 0.1 \, \text{V}\) 缩小至 \(\pm 0.001 \, \text{V}\)。缺点：迭代次数大幅增加，计算耗时延长。例如，当 \(\text{target}\) 从 \(1e-3\) 降至 \(1e-6\) 时，迭代次数可能从 2000 次增至 10000 次。低精度设置（如 \(\text{target}=1e-2\)）：优势：迭代快速终止，计算效率高，适合初步调试或定性分析。缺点：解可能未充分收敛，存在明显的系统误差。例如，电势分布可能残留周期性波动，峰值电势与理论值的偏差超过 5%。

### 5.3 物理意义

**问题：** 从物理角度解释为什么正负电荷之间会形成这样的电势分布？

**回答：**电势与电荷的基本关系：正电荷周围电势为正（电势源），负电荷周围电势为负（电势汇），这是由泊松方程 \(\nabla^2 \phi = -\rho/\varepsilon_0\) 决定的 —— 电荷密度 \(\rho\) 与电势的二阶导数相关。正电荷附近，电势随距离衰减（类似点电荷电势 \(\phi \propto 1/r\)）；负电荷附近，电势随距离升高（电势最小值出现在电荷中心）。电场与电势的关联：电场 \(\vec{E} = -\nabla \phi\)，方向为电势梯度的反方向。因此，正负电荷之间的电场线从正电荷指向负电荷，电势沿电场线方向降低，形成 “正电荷周围高电势、负电荷周围低电势” 的分布特征。两电荷连线中点处，若电荷量相等，电势为零（因正负电势叠加抵消），但电场强度不为零（电场线在此处密度最大）。
物理图像示例：假设正电荷位于 \((a,0)\)，负电荷位于 \((-a,0)\)，则：正电荷附近区域电势为正，负电荷附近为负；两电荷之间的区域，电势从正逐渐过渡到负，形成电势梯度；无穷远处电势为零，符合边界条件。
## 6. 代码改进建议

1. **性能优化：** 可以考虑使用SOR（逐次超松弛）方法加速收敛
2. **可视化增强：** 添加等势线图和电场矢量图
3. **参数化设计：** 使电荷位置和强度可配置

## 7. 参考资料

1. 计算物理学教材相关章节
2. NumPy和Matplotlib官方文档
3. 数值分析相关资料
