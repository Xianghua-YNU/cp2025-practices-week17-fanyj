# 项目：常微分方程的松弛迭代法 - 实验报告

**学生姓名：** 范玉洁**学号：** 20221050183 **完成日期：** 6.18

## 1. 实验目的

学习松弛迭代法求解常微分方程边值问题，通过抛体运动实例掌握数值方法的实现。

## 2. 核心算法

### 2.1 算法思路

使用二阶中心差分近似二阶导数，将微分方程转化为差分方程，然后通过松弛迭代法求解边值问题。

### 2.2 关键代码片段

```python
# 松弛迭代核心代码
while delta > tol:
    x_new = np.copy(x)
    x_new[1:-1] = 0.5 * (h * h * g + x[2:] + x[:-2])
    delta = np.max(np.abs(x_new - x))
    x = x_new
```

## 3. 实验结果
![image](https://github.com/user-attachments/assets/63cd5f5e-573e-43af-a95c-ec48b462cf48)

### 3.1 主要输出

- 最大高度：122.5 m（理论值：\(h_{max} = \frac{gT^2}{8} = \frac{9.8 \times 10^2}{8} = 122.5\)） m
- 到达最大高度时间：：5.0 s（理论值：\(t_{max} = \frac{T}{2} = 5.0\)） s
- 迭代收敛次数：约 1250 次（实际迭代次数与收敛容差相关）次

### 3.2 结果验证

- 边界条件满足：x(0) = 0, x(10) = 0
- 轨迹对称性：关于 t = 5s 对称
- 物理合理性：抛体轨迹呈抛物线形状

## 4. 问题与收获

### 4.1 主要问题

1. 收敛条件的设置
收敛条件的设置为何选择最大变化量？解答：
松弛法的收敛判据通常基于解向量的变化幅度。选择 \(\delta = \max|\Delta x_i|\) 作为收敛条件，是因为：该指标直接反映解的全局变化程度，确保所有点的更新幅度均小于容差；相比平均变化量，最大值更能体现局部可能存在的发散风险（如边界附近的波动）。
3. 迭代公式的正确实现
  边界点（\(t=0\) 和 \(t=10\)）受约束条件 \(x(0)=x(10)=0\)，因此在迭代中保持固定。内部点通过差分公式与相邻点耦合，需通过迭代更新直至满足方程：\(x_i = 0.5h^2g + 0.5(x_{i+1} + x_{i-1})\)其中 i 对应数组索引 1 至 n-2（n 为数组长度）。

### 4.2 解决方法

1. 使用最大变化量作为收敛判据
2. 仔细处理数组索引，确保边界条件

### 4.3 主要收获

通过本实验掌握了松弛迭代法的基本原理，理解了边值问题与初值问题的区别，学会了用数值方法求解物理问题。

## 5. 思考题（可选）

1. 为什么松弛法适合求解边值问题而不是初值问题？
   松弛法是一种迭代求解线性方程组的方法，其核心思想是通过逐步更新解向量直至收敛。边值问题（BVP）的特点是在多个边界点上给定约束条件（如\(x(0)=0, x(10)=0\)），这导致求解区域内的每个点都与其他点存在耦合关系，形成大型线性方程组。松弛法通过迭代逐步满足所有边界条件，适合处理这种全局耦合性。相比之下，初值问题（IVP）的约束条件仅在单一初始点给出（如\(x(0)=0, v(0)=v_0\)），其解可以通过显式的时间推进方法（如欧拉法、龙格 - 库塔法）直接求解，无需迭代。松弛法应用于初值问题时，由于缺乏全局约束，迭代过程无法有效收敛或效率低下。
3. 如何选择合适的收敛容差和最大迭代次数？
   收敛容差（tol）：
容差的选择取决于问题的物理精度需求和数值方法的稳定性。对于抛体运动问题，若物理测量精度为厘米级（\(10^{-2}\) m），则容差可设为\(10^{-4}\)至\(10^{-6}\)，确保数值误差远小于测量误差。过小的容差会显著增加计算量，而过大的容差可能导致解偏离真实值。最大迭代次数（max_iter）：
最大迭代次数应根据问题的复杂度和松弛法的收敛速度估计。对于简单问题（如抛体运动），可通过试错法确定收敛所需的大致迭代次数（如 1000-10000 次）。设置上限可防止算法在不收敛时陷入无限循环。若实际迭代次数接近上限，可能需要调整容差或改进迭代公式（如使用超松弛法加速收敛）。
